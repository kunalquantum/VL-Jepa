<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VL-JEPA vs Traditional LLMs: Research-Grade Visualization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .academic-grid {
            background-image: linear-gradient(#e5e7eb 1px, transparent 1px),
                linear-gradient(90deg, #e5e7eb 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Analysis Graph Line Animation */
        .path-draw {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: draw 3s linear forwards infinite;
        }

        @keyframes draw {
            to {
                stroke-dashoffset: 0;
            }
        }

        @keyframes flowLine {
            from {
                stroke-dashoffset: 20;
            }

            to {
                stroke-dashoffset: 0;
            }
        }

        .animate-flow {
            animation: flowLine 1s linear infinite;
        }

        .fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .pulse-ring::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border-radius: inherit;
            border: 2px solid currentColor;
            opacity: 0;
            animation: pulseRing 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }

        @keyframes pulseRing {
            0% {
                transform: scale(0.9);
                opacity: 0.7;
            }

            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }
    </style>
</head>

<body class="bg-white text-slate-800 h-screen flex flex-col overflow-hidden academic-grid">

    <!-- Header -->
    <header class="bg-white/90 backdrop-blur-sm border-b border-slate-200 px-6 py-3 z-20 flex-shrink-0">
        <div class="max-w-full mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-xl font-bold tracking-tight text-slate-900">VL-JEPA vs Traditional LLMs</h1>
                <p class="text-xs text-slate-500 font-medium">Research-Grade System & Architecture Comparison</p>
            </div>
            <div class="flex gap-6 text-[10px] font-bold uppercase tracking-wider text-slate-400">
                <div class="flex items-center gap-1">
                    <div class="w-2 h-2 rounded-full bg-blue-500"></div> Autoregressive
                </div>
                <div class="flex items-center gap-1">
                    <div class="w-2 h-2 rounded-full bg-orange-500"></div> Joint Embedding Prediction
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 flex relative overflow-hidden">

        <!-- CENTER DIVIDER LABELS -->
        <div
            class="absolute left-1/2 top-10 bottom-10 w-px bg-slate-300 transform -translate-x-1/2 z-10 flex flex-col justify-evenly py-10 pointer-events-none">
            <!-- Labels positioned to align with diagram sections -->
        </div>

        <!-- LEFT COLUMN: TRADITIONAL LLM -->
        <section id="section-llm"
            class="flex-1 border-r border-slate-200 flex flex-col items-center relative overflow-y-auto bg-blue-50/10 transition-all duration-500">
            <div class="w-full max-w-xl p-8 flex flex-col items-center">

                <!-- HEADER -->
                <div class="text-center mb-8">
                    <h2 class="text-lg font-bold text-slate-800">Traditional LLM</h2>
                    <div class="text-xs font-mono text-blue-600 bg-blue-50 px-2 py-1 rounded mt-1 inline-block">p(x_t |
                        x_{&lt;t})</div>
                </div>

                <!-- DIAGRAM -->
                <div class="relative w-full flex flex-col items-center gap-6">

                    <!-- Input Context -->
                    <div class="w-full group relative">
                        <div
                            class="absolute -left-20 top-2 text-[10px] font-bold text-slate-400 uppercase text-right w-16">
                            Input Sequence</div>
                        <div id="llm-input-box"
                            class="w-full p-4 bg-white border border-slate-300 rounded-lg shadow-sm font-mono text-sm text-slate-700 flex gap-2 overflow-x-auto">
                            <span class="bg-slate-100 px-1 rounded">The</span>
                            <span class="bg-slate-100 px-1 rounded">cat</span>
                            <span class="bg-slate-100 px-1 rounded">sat</span>
                            <span class="bg-slate-100 px-1 rounded">on</span>
                        </div>
                    </div>

                    <!-- Arrow -->
                    <svg class="w-6 h-10 text-slate-300" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 0v10l-4 4m4-4l4 4v20"></path>
                    </svg>

                    <!-- Transformer Block -->
                    <div id="llm-transformer"
                        class="w-full h-24 bg-blue-50 border-2 border-blue-200 rounded-lg flex flex-col items-center justify-center relative transition-all duration-200">
                        <span class="text-xs font-bold text-blue-800 uppercase tracking-widest mb-1">Transformer
                            Decoder</span>
                        <div class="flex gap-1 opacity-50">
                            <div class="w-1 h-4 bg-blue-400 rounded-full"></div>
                            <div class="w-1 h-4 bg-blue-400 rounded-full"></div>
                            <div class="w-1 h-4 bg-blue-400 rounded-full"></div>
                        </div>

                        <!-- Compute Label -->
                        <div class="absolute right-2 top-2 text-[9px] text-blue-400 font-mono">N Layers</div>
                    </div>

                    <!-- Softmax / Token Gen -->
                    <div class="w-full flex flex-col items-center relative">
                        <svg class="w-6 h-8 text-slate-300" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 0v12"></path>
                        </svg>

                        <div id="llm-softmax"
                            class="w-3/4 h-12 border border-slate-200 bg-white rounded flex items-center justify-center text-xs text-slate-500 shadow-sm relative overflow-hidden">
                            <div class="absolute inset-y-0 left-0 bg-blue-100 w-[0%]" id="softmax-bar"></div>
                            <span class="z-10 relative">Softmax (Vocab Size)</span>
                        </div>

                        <!-- Loss Visual -->
                        <div class="absolute -right-24 top-2 flex items-center gap-2">
                            <div class="text-[10px] text-red-500 font-bold">Cross Entropy Loss</div>
                            <div
                                class="w-4 h-4 border border-red-300 rounded-full flex items-center justify-center text-[10px] text-red-500 font-mono">
                                L</div>
                        </div>
                    </div>

                    <!-- Output Token -->
                    <div class="mt-2 text-center relative z-10">
                        <div id="llm-new-token"
                            class="inline-block px-4 py-2 bg-blue-600 text-white font-mono font-bold rounded shadow-lg transform scale-0 transition-transform">
                            ?
                        </div>
                        <div class="text-[10px] text-slate-400 mt-1">Next Token</div>
                    </div>

                    <!-- Autoregressive Loop Arrow (Big Visual Feature) -->
                    <div id="llm-loop-arrow"
                        class="absolute top-[60px] left-[-20px] w-[calc(100%+40px)] h-[calc(100%-40px)] pointer-events-none opacity-0 transition-opacity duration-300">
                        <svg class="w-full h-full" overflow="visible">
                            <!-- Path goes from bottom token back up to input -->
                            <path d="M 120 280 C -40 280 -40 40 40 40" fill="none" stroke="#60a5fa" stroke-width="3"
                                stroke-dasharray="8 4" class="animate-flow"></path>
                            <path d="M 40 40 L 30 35 L 30 45 Z" fill="#60a5fa"></path>
                        </svg>
                        <div
                            class="absolute top-1/2 -left-12 bg-white border border-blue-200 px-2 py-1 rounded text-[10px] text-blue-600 font-bold shadow-sm">
                            Step N+1
                        </div>
                    </div>

                </div>

                <!-- NEGATIVE SPACE (What it lacks) -->
                <div class="mt-12 w-full border-t border-slate-100 pt-6">
                    <h3 class="text-xs font-bold text-slate-400 uppercase mb-3">Architectural Limitations</h3>
                    <ul class="space-y-2">
                        <li class="flex items-center gap-2 text-xs text-slate-500 opacity-70">
                            <span class="text-red-400 font-bold text-lg">×</span> No Explicit World Model
                        </li>
                        <li class="flex items-center gap-2 text-xs text-slate-500 opacity-70">
                            <span class="text-red-400 font-bold text-lg">×</span> No Latent Planning
                        </li>
                    </ul>
                </div>

                <!-- COMPUTE GRAPH -->
                <div class="mt-8 w-full">
                    <div class="text-[10px] font-bold text-slate-400 mb-1">Compute Cost vs Time</div>
                    <div class="h-16 border-l border-b border-slate-300 relative">
                        <!-- Stair step graph -->
                        <svg class="absolute inset-0 w-full h-full" preserveAspectRatio="none">
                            <polyline points="0,60 20,60 20,45 40,45 40,30 60,30 60,15 80,15" fill="none"
                                stroke="#64748b" stroke-width="2"></polyline>
                        </svg>
                        <div class="absolute bottom-1 right-1 text-[8px] text-slate-400">Time</div>
                        <div class="absolute top-1 left-2 text-[8px] text-slate-500 font-bold bg-white px-1">O(n)</div>
                    </div>
                </div>

            </div>
        </section>

        <!-- RIGHT COLUMN: VL-JEPA -->
        <section id="section-jepa"
            class="flex-1 flex flex-col items-center relative overflow-y-auto bg-orange-50/10 transition-all duration-500">
            <div class="w-full max-w-xl p-8 flex flex-col items-center">

                <!-- HEADER -->
                <div class="text-center mb-8">
                    <h2 class="text-lg font-bold text-slate-800">VL-JEPA</h2>
                    <div class="text-xs font-mono text-orange-600 bg-orange-50 px-2 py-1 rounded mt-1 inline-block">
                        sim(pred(x), enc(y))</div>
                </div>

                <!-- DIAGRAM (Dual Encoder Logic) -->
                <div class="relative w-full grid grid-cols-2 gap-x-4 gap-y-6">

                    <!-- Labels -->
                    <div class="col-span-1 text-center text-[10px] font-bold text-orange-600 uppercase">Context Path
                    </div>
                    <div class="col-span-1 text-center text-[10px] font-bold text-slate-400 uppercase">Target Path
                        (Masked)</div>

                    <!-- Input 1: Unmasked Context -->
                    <div class="col-span-1 flex flex-col items-center">
                        <div class="w-32 h-20 bg-slate-100 border border-slate-300 rounded overflow-hidden relative"
                            id="jepa-context-img">
                            <!-- Image with hole -->
                            <img src="https://images.unsplash.com/photo-1543852786-1cf6624b9987?q=80&w=200"
                                class="w-full h-full object-cover opacity-80">
                            <div class="absolute inset-0 bg-white/30"></div> <!-- Context filter -->
                        </div>
                        <div class="text-[9px] mt-1 text-slate-500">x (Unmasked)</div>
                        <!-- Arrow -->
                        <svg class="w-4 h-6 text-slate-300 my-1" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M8 0v24"></path>
                        </svg>

                        <!-- Context Encoder -->
                        <div id="box-enc-context"
                            class="w-28 h-12 bg-orange-100 border border-orange-300 rounded flex items-center justify-center text-[10px] font-bold text-orange-800 shadow-sm">
                            Context Encoder
                        </div>
                    </div>

                    <!-- Input 2: Masked Target -->
                    <div class="col-span-1 flex flex-col items-center opacity-70">
                        <div class="w-32 h-20 bg-slate-800 border border-slate-600 rounded flex items-center justify-center relative"
                            id="jepa-target-img">
                            <span class="text-white/50 text-2xl font-bold">?</span>
                            <div class="absolute top-1 right-1 text-[8px] text-white/50 bg-black/50 px-1 rounded">Target
                            </div>
                        </div>
                        <div class="text-[9px] mt-1 text-slate-500">y (Masked)</div>
                        <!-- Arrow -->
                        <svg class="w-4 h-6 text-slate-300 my-1" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M8 0v24"></path>
                        </svg>

                        <!-- Target Encoder (EMA) -->
                        <div id="box-enc-target"
                            class="w-28 h-12 bg-slate-100 border border-slate-300 rounded flex flex-col items-center justify-center text-[10px] font-bold text-slate-500 relative">
                            Target Encoder
                            <div class="text-[8px] font-normal text-slate-400">(EMA / Stop Grad)</div>
                            <div class="absolute -top-2 -right-2 bg-slate-200 rounded-full p-1"><svg
                                    class="w-3 h-3 text-slate-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path
                                        d="M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v5a2 2 0 002 2h10a2 2 0 002-2v-5a2 2 0 00-2-2H7V7a3 3 0 015.905-.75 1 1 0 001.937-.5A5.002 5.002 0 0010 2z" />
                                </svg></div>
                        </div>
                    </div>

                    <!-- Embeddings Level -->
                    <div class="col-span-1 flex justify-center">
                        <div id="emb-context"
                            class="w-8 h-8 rounded-full bg-orange-400 shadow-lg shadow-orange-400/40 animate-pulse">
                        </div>
                    </div>
                    <div class="col-span-1 flex justify-center">
                        <div id="emb-target" class="w-8 h-8 rounded-full bg-slate-400 opacity-50"></div>
                    </div>

                    <!-- Predictor Block (Connecting Left to Right logic visually) -->
                    <div
                        class="col-span-2 relative h-32 mt-2 bg-orange-50/30 rounded-xl border border-dashed border-orange-200 mx-4">
                        <div class="absolute top-2 left-2 text-[9px] font-bold text-orange-300 uppercase">Latent
                            Prediction</div>

                        <!-- Diagram Lines -->
                        <svg class="absolute inset-0 w-full h-full pointer-events-none">
                            <!-- From Context Emb to Predictor -->
                            <path d="M 75 10 L 140 50" stroke="#fb923c" stroke-width="2" fill="none"
                                marker-end="url(#arrowhead)"></path>
                            <!-- Predictor Output -->
                            <path d="M 230 50 L 300 30" stroke="#fb923c" stroke-width="2" fill="none"
                                stroke-dasharray="4 2"></path>
                        </svg>

                        <!-- The Predictor Unit -->
                        <div id="box-predictor"
                            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-24 h-12 bg-white border-2 border-orange-400 rounded-lg flex items-center justify-center text-xs font-bold text-orange-600 shadow-md">
                            Predictor
                        </div>

                        <!-- Prediction MATCH visual -->
                        <div id="pred-match-visual"
                            class="absolute right-12 top-6 flex flex-col items-center opacity-0 transition-opacity duration-500">
                            <div class="text-[10px] font-bold text-orange-600 mb-1">ẑ (Pred)</div>
                            <div class="w-6 h-6 rounded-full bg-orange-500 shadow-lg"></div>

                            <!-- Loss Connection -->
                            <div class="h-8 w-px bg-red-400 my-1"></div>
                            <div class="text-[9px] font-bold text-red-500 bg-red-50 px-1 rounded">L2 Loss</div>
                            <div class="h-8 w-px bg-red-400 my-1"></div>

                            <div class="w-6 h-6 rounded-full bg-slate-400 mt-1 opacity-50"></div>
                            <div class="text-[10px] font-bold text-slate-500 mt-1">z (Target)</div>
                        </div>

                    </div>

                </div>

                <!-- NEGATIVE SPACE -->
                <div class="mt-8 w-full border-t border-slate-100 pt-6">
                    <h3 class="text-xs font-bold text-slate-400 uppercase mb-3">Eliminated Inefficiencies</h3>
                    <ul class="space-y-2">
                        <li class="flex items-center gap-2 text-xs text-slate-500 opacity-70">
                            <span class="text-red-400 font-bold text-lg">×</span> No Pixel Generation
                        </li>
                        <li class="flex items-center gap-2 text-xs text-slate-500 opacity-70">
                            <span class="text-red-400 font-bold text-lg">×</span> No Token Softmax
                        </li>
                        <li class="flex items-center gap-2 text-xs text-slate-500 opacity-70">
                            <span class="text-red-400 font-bold text-lg">×</span> No Autoregressive Loop
                        </li>
                    </ul>
                </div>

                <!-- COMPUTE GRAPH -->
                <div class="mt-8 w-full">
                    <div class="text-[10px] font-bold text-slate-400 mb-1">Compute Cost vs Time</div>
                    <div class="h-16 border-l border-b border-slate-300 relative">
                        <!-- Flat line graph -->
                        <svg class="absolute inset-0 w-full h-full" preserveAspectRatio="none">
                            <line x1="0" y1="45" x2="80" y2="45" stroke="#f97316" stroke-width="2"></line>
                        </svg>
                        <div class="absolute bottom-1 right-1 text-[8px] text-slate-400">Time</div>
                        <div class="absolute top-8 right-2 text-[8px] text-orange-500 font-bold bg-white px-1">O(1)
                            Parallel</div>
                    </div>
                </div>

            </div>
        </section>

    </main>

    <!-- Footer Controls -->
    <div
        class="fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-white/90 backdrop-blur border border-slate-200 p-1.5 rounded-full shadow-2xl z-50 flex gap-2 scale-90">
        <button onclick="setFocus('left')" id="btn-left"
            class="px-5 py-2 rounded-full text-xs font-bold uppercase transition-all hover:bg-slate-50 text-slate-500 tracking-wide">
            Focus LLM
        </button>
        <button onclick="setFocus('both')" id="btn-both"
            class="px-5 py-2 rounded-full text-xs font-bold uppercase bg-slate-900 text-white shadow-lg ring-1 ring-slate-900 transition-all tracking-wide">
            Compare Both
        </button>
        <button onclick="setFocus('right')" id="btn-right"
            class="px-5 py-2 rounded-full text-xs font-bold uppercase transition-all hover:bg-slate-50 text-slate-500 tracking-wide">
            Focus VL-JEPA
        </button>
    </div>

    <!-- SCRIPTS -->
    <script>
        // --- FOCUS MANAGEMENT ---
        let currentFocus = 'both';
        function setFocus(mode) {
            currentFocus = mode;
            const btnLeft = document.getElementById('btn-left');
            const btnBoth = document.getElementById('btn-both');
            const btnRight = document.getElementById('btn-right');

            const activeClass = "bg-slate-900 text-white shadow-lg";
            const inactiveClass = "bg-transparent text-slate-500 hover:bg-slate-50";

            btnLeft.className = `px-5 py-2 rounded-full text-xs font-bold uppercase transition-all tracking-wide ${mode === 'left' ? activeClass : inactiveClass}`;
            btnBoth.className = `px-5 py-2 rounded-full text-xs font-bold uppercase transition-all tracking-wide ${mode === 'both' ? activeClass : inactiveClass}`;
            btnRight.className = `px-5 py-2 rounded-full text-xs font-bold uppercase transition-all tracking-wide ${mode === 'right' ? activeClass : inactiveClass}`;

            const leftSec = document.getElementById('section-llm');
            const rightSec = document.getElementById('section-jepa');

            if (mode === 'left') {
                leftSec.style.opacity = '1'; leftSec.style.filter = 'none';
                rightSec.style.opacity = '0.3'; rightSec.style.filter = 'grayscale(100%)';
            } else if (mode === 'right') {
                leftSec.style.opacity = '0.3'; leftSec.style.filter = 'grayscale(100%)';
                rightSec.style.opacity = '1'; rightSec.style.filter = 'none';
            } else {
                leftSec.style.opacity = '1'; leftSec.style.filter = 'none';
                rightSec.style.opacity = '1'; rightSec.style.filter = 'none';
            }
        }

        // --- LLM ANIMATION ---
        const llmTokens = ["The", "cat", "sat", "on", "the", "mat", "."];
        let llmIdx = 0;
        const llmInputBox = document.getElementById('llm-input-box');
        const llmNewToken = document.getElementById('llm-new-token');
        const llmTransformer = document.getElementById('llm-transformer');
        const llmLoopArrow = document.getElementById('llm-loop-arrow');
        const softmaxBar = document.getElementById('softmax-bar');

        async function stepLLM() {
            if (currentFocus === 'right') { setTimeout(stepLLM, 100); return; }

            if (llmIdx >= llmTokens.length) {
                // Reset
                await new Promise(r => setTimeout(r, 2000));
                llmInputBox.innerHTML = '<span class="bg-slate-100 px-1 rounded">Start</span>';
                llmIdx = 0;
            }

            // 1. Transformer Compute
            llmTransformer.classList.add('bg-blue-100', 'scale-[1.02]', 'shadow-md');
            await new Promise(r => setTimeout(r, 600));
            llmTransformer.classList.remove('bg-blue-100', 'scale-[1.02]', 'shadow-md');

            // 2. Softmax Fill
            softmaxBar.style.width = '100%';
            softmaxBar.style.transition = 'width 0.3s ease';
            await new Promise(r => setTimeout(r, 400));
            softmaxBar.style.width = '0%';
            softmaxBar.style.transition = 'none';

            // 3. Emit Token
            const word = llmTokens[llmIdx];
            llmNewToken.innerText = word;
            llmNewToken.classList.remove('scale-0');
            await new Promise(r => setTimeout(r, 500));

            // 4. Loop Back
            llmLoopArrow.style.opacity = '1';
            await new Promise(r => setTimeout(r, 800));

            // 5. Append to Context
            const span = document.createElement('span');
            span.className = "bg-blue-100/50 px-1 rounded text-blue-700 animate-pulse";
            span.innerText = word;
            llmInputBox.appendChild(span);

            llmNewToken.classList.add('scale-0');
            llmLoopArrow.style.opacity = '0';

            llmIdx++;
            setTimeout(stepLLM, 500);
        }

        // --- JEPA ANIMATION (Dual Encoder) ---
        const encContext = document.getElementById('box-enc-context');
        const predictor = document.getElementById('box-predictor');
        const predVisual = document.getElementById('pred-match-visual');
        const embTarget = document.getElementById('emb-target');

        async function stepJEPA() {
            if (currentFocus === 'left') { setTimeout(stepJEPA, 100); return; }

            // Reset
            predVisual.style.opacity = '0';
            embTarget.style.opacity = '0.3';

            await new Promise(r => setTimeout(r, 1000));

            // 1. Context Encode
            encContext.classList.add('bg-orange-200', 'scale-105');
            await new Promise(r => setTimeout(r, 600));
            encContext.classList.remove('bg-orange-200', 'scale-105');

            // 2. Predictor Process
            predictor.classList.add('bg-orange-50', 'ring-2', 'ring-orange-300');
            await new Promise(r => setTimeout(r, 800));
            predictor.classList.remove('bg-orange-50', 'ring-2', 'ring-orange-300');

            // 3. Show Prediction & Loss Logic
            predVisual.style.opacity = '1';
            embTarget.style.opacity = '1';

            await new Promise(r => setTimeout(r, 3000)); // Hold visual

            stepJEPA();
        }

        // Init
        stepLLM();
        stepJEPA();

    </script>
</body>

</html>